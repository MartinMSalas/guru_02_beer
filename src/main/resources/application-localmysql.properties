# ======================================================
# DATASOURCE
# ======================================================
spring.datasource.username=mrestadmin
spring.datasource.password=mrestadmin
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/restdb?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.database=mysql

# ======================================================
# HIKARI
# ======================================================
spring.datasource.hikari.pool-name=RestDB-Pool
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.data-source-properties.cachePrepStmts=true
spring.datasource.hikari.data-source-properties.prepStmtCacheSize=250
spring.datasource.hikari.data-source-properties.prepStmtCacheSqlLimit=2048
spring.datasource.hikari.data-source-properties.useServerPrepStmts=true
spring.datasource.hikari.data-source-properties.useLocalSessionState=true
spring.datasource.hikari.data-source-properties.rewriteBatchedStatements=true
spring.datasource.hikari.data-source-properties.cacheResultSetMetadata=true
spring.datasource.hikari.data-source-properties.cacheServerConfiguration=true
spring.datasource.hikari.data-source-properties.elideSetAutoCommits=true
spring.datasource.hikari.data-source-properties.maintainTimeStats=false


# ======================================================
# JPA / HIBERNATE
# ======================================================

# Do not modify the database schema automatically, use migrations instead
spring.jpa.hibernate.ddl-auto=validate
# To enable schema generation
# spring.jpa.hibernate.ddl-auto=none
# Delay DataSource initialization until after Hibernate is initialized
# spring.jpa.defer-datasource-initialization=true
#Format SQL
spring.jpa.properties.hibernate.format_sql=true

spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect


# ======================================================
# Create / Drop the database schema on startup
# ======================================================
# spring.jpa.properties.jakarta.persistence.schema-generation.create-source=metadata
# spring.jpa.properties.jakarta.persistence.schema-generation.scripts.action=create
# spring.jpa.properties.jakarta.persistence.schema-generation.scripts.create-target=create.sql
# ======================================================
# SQL LOGGING
# ======================================================
#Show SQL
spring.jpa.properties.hibernate.show_sql=true
logging.level.org.hibernate.SQL=DEBUG
#Show bind values
logging.level.org.hibernate.orm.jdbc.bind=trace
logging.level.org.hibernate.tool.schema=DEBUG
logging.level.com.zaxxer.hikari=DEBUG

# === Flyway ==========================================
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true

# == Docker Compose ================================
spring.docker.compose.enabled=true